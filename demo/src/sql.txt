CREATE DATABASE hotel_management;
USE hotel_management;

CREATE TABLE IF NOT EXISTS user (
    id INTEGER PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(255) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    role ENUM('Manager', 'Staff') NOT NULL
);

CREATE TABLE IF NOT EXISTS customer (
    id INTEGER PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL,
    gender ENUM('Male', 'Female', 'Other') DEFAULT 'Other',
    birthday DATE NOT NULL,
    identification VARCHAR(20) NOT NULL UNIQUE,
    hometown VARCHAR(255) NOT NULL,
    rent_date DATE
);

CREATE TABLE IF NOT EXISTS employee (
    id INTEGER PRIMARY KEY AUTO_INCREMENT,
    user_id INTEGER,
    name VARCHAR(255) NOT NULL,
    hometown VARCHAR(255) NOT NULL,
    identification VARCHAR(20) NOT NULL UNIQUE,
    birthday DATE NOT NULL,
    gender ENUM('Male', 'Female', 'Other') DEFAULT 'Other',
    position ENUM('Manager', 'Staff') NOT NULL,
    salary INTEGER,
    FOREIGN KEY (user_id) REFERENCES user(id)
);

CREATE TABLE IF NOT EXISTS service (
    name VARCHAR(255) PRIMARY KEY NOT NULL,
    cost INTEGER NOT NULL
);

CREATE TABLE IF NOT EXISTS room (
    id INTEGER PRIMARY KEY AUTO_INCREMENT,
    renter_id INTEGER,
    is_rented BOOLEAN DEFAULT FALSE,
    rent_date DATE,
    departure_date DATE,
    price INTEGER NOT NULL DEFAULT 0,
    bill_id INTEGER,
    FOREIGN KEY (renter_id) REFERENCES customer(id)
);

CREATE TABLE IF NOT EXISTS room_service (
    id INTEGER PRIMARY KEY AUTO_INCREMENT,
    room_id INTEGER,
    service_name VARCHAR(255),
    process ENUM('Finished', 'Processing') DEFAULT 'Processing',
    FOREIGN KEY (room_id) REFERENCES room(id),
    FOREIGN KEY (service_name) REFERENCES service(name)
);

CREATE TABLE IF NOT EXISTS bill (
    id INTEGER PRIMARY KEY AUTO_INCREMENT,
    room_id INTEGER,
    renter_id INTEGER,
    rent_date DATE,
    departure_date DATE,
    price INTEGER NOT NULL DEFAULT 0,
    process ENUM('Finished', 'Processing'),
    FOREIGN KEY (room_id) REFERENCES room(id),
    FOREIGN KEY (renter_id) REFERENCES customer(id)
);


ALTER TABLE room
ADD CONSTRAINT fk_room_bill FOREIGN KEY (bill_id) REFERENCES bill(id);

-- Thêm dữ liệu cho 20 phòng với giá mặc định là 50,000
INSERT INTO room (renter_id, is_rented, rent_date, departure_date, price)
VALUES
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000),
    (NULL, FALSE, NULL, NULL, 50000);

-- Thêm dữ liệu cho 20 dịch vụ
INSERT INTO service (name, cost)
VALUES
    ('Breakfast', 20000),
    ('Wi-Fi', 0),
    ('Parking', 10000),
    ('Laundry', 20000),
    ('Room Cleaning', 30000),
    ('Airport Shuttle', 100000),
    ('Mini Bar', 150000),
    ('Spa Services', 200000),
    ('Gym Access', 100000),
    ('Late Checkout', 100000),
    ('Pet Friendly', 50000),
    ('Conference Room Rental', 500000),
    ('Car Rental', 100000),
    ('Bicycle Rental', 60000),
    ('Concierge Service', 100000),
    ('Business Center Access', 70000),
    ('Pool Access', 50000),
    ('Private Chef', 200000),
    ('In-Room Massage', 500000),
    ('Event Planning', 1000000);
